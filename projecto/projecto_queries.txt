Quais s~ao os utilizadores que falharam o login mais vezes do que tiveram sucesso?

  SELECT userid
  FROM login
  where (contador_login-sucesso) > sucesso;

SELECT DISTINCT COUNT(*), userid
FROM login l1
WHERE sucesso=0
GROUP BY userid
HAVING COUNT(*) > (
	SELECT COUNT(*)
	FROM login l2
	WHERE sucesso=1 AND l1.userid=l2.userid
	GROUP BY userid);


 Quais s~ao os registos que aparecem em todas as paginas de um utilizador?

DROP TABLE IF EXISTS user_pages;
CREATE TEMPORARY TABLE IF NOT EXISTS
user_pages
SELECT pageid
FROM reg_pag
WHERE userid=2607;

DROP TABLE IF EXISTS user_reg;
CREATE TEMPORARY TABLE IF NOT EXISTS
user_reg
SELECT regid
FROM reg_pag
WHERE userid=2607;

DROP TABLE IF EXISTS user_pages_reg;
CREATE TEMPORARY TABLE IF NOT EXISTS
user_pages_reg
SELECT r1.regid, r1.pageid
FROM reg_pag r1
WHERE userid=2607;

SELECT *
FROM user_reg ur1
WHERE user_reg.regid NOT IN(
	SELECT upr.regid
	FROM user_pages_reg upr
	WHERE upr.regid=ur1.regid
	WHERE COUNT(distinct upr.pageid) - SELECT COUNT(*) FROM user_pages;
);



WHERE NOT EXISTS(
	SELECT r1.regid
	FROM reg_pag r1
	WHERE

				SELECT pageid
				FROM reg_pag
				WHERE userid=2607
);
HAVING reg_pag


SELECT DISTINCT d.customer_name
FROM depositor d NATURAL JOIN account a NATURAL JOIN branch
WHERE NOT EXISTS (
  SELECT branch_name
  FROM branch b
  WHERE branch_name NOT IN (
	SELECT branch_name
	FROM account a2
	WHERE a.account_number = a2.account_number
  )
)

 select pagina.pagecounter from pagina where userid=2607;

SELECT pageid
FROM reg_pag
WHERE userid=2607;

Quais os utilizadores que tem o maior numero medio de registos por pagina?
SELECT regid, pageid FROM reg_pag WHERE userid=2607;
